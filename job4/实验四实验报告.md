#### 实验四

##### 实验任务

- [x] 任务一：用bash编写一个图片批处理脚本，实现以下功能：
  - 支持命令行参数方式使用不同功能
  - 支持对指定目录下所有支持格式的图片文件进行批处理   **指定目录进行批处理**
  - 支持以下常见图片批处理功能的单独使用或**组合**使用
    - 支持对jpeg格式图片进行图片质量压缩
    - 支持对jpeg/png/svg格式图片在保持原始宽高比的前提下压缩分辨率
    - 支持对图片批量添加自定义文本水印
    - 支持批量重命名（统一添加文件名前缀或后缀，不影响原始文件扩展名）
    - 支持将png/svg图片统一转换为jpg格式

---



- [x] 任务二：用bash编写一个文本批处理脚本，对以下附件分别进行批量处理完成相应的数据统计任务：

  2014世界杯运动员数据

  - 统计不同年龄区间范围（20岁以下、[20-30]、30岁以上）的球员**数量**、**百分比**
  - 统计不同场上位置的球员**数量**、**百分比**
  - 名字最长的球员是谁？名字最短的球员是谁？
  - 年龄最大的球员是谁？年龄最小的球员是谁？

- [x] 任务二：用bash编写一个文本批处理脚本，对以下附件分别进行批量处理完成相应的数据统计任务：

  Web服务器访问日志

  - 统计访问来源主机TOP 100和分别对应出现的总次数
  - 统计访问来源主机TOP 100 IP和分别对应出现的总次数
  - 统计最频繁被访问的URL TOP 100
  - 统计不同响应状态码的出现次数和对应百分比
  - 分别统计不同4XX状态码对应的TOP 10 URL和对应出现的总次数
  - 给定URL输出TOP 100访问来源主机



##### 实验报告

###### 任务一 用bash编写一个图片批处理脚本，实现以下功能：

- 使用工具

  - imagemagick

- 测试语句

  - 支持对jpeg格式图片进行图片质量压缩

    `bash job4/img.sh -d job4/img -q 50 `

  - 支持对jpeg/png/svg格式图片在保持原始宽高比的前提下压缩分辨

    `bash job4/img.sh -d job4/img -r 50%x50% `

  - 支持对图片批量添加自定义文本水印

    `bash job4/img.sh -d job4/img -w "hello world"`

  - 支持批量重命名（统一添加文件名前缀，不影响原始文件扩展名）

    `bash job4/img.sh -d job4/img --prefix "haha"`

  - 支持将png/svg图片统一转换为jpg格式图片

    `bash job4/img.sh -d job4/img -c `

  - 支持多参数混合使用，如将png/svg图片统一转换为jpg格式图片后添加水印

    `bash job4/img.sh -d job4/img -c -w  "hello world"`

###### 任务二：用bash编写一个文本批处理脚本，对以下附件分别进行批量处理完成相应的数据统计任务：

- 使用工具

  - more
  - awk 
  - sort
  - uniq

- 测试语句

  `bash job4/world_cup.sh`



###### 任务二：用bash编写一个文本批处理脚本，对以下附件分别进行批量处理完成相应的数据统计任务：

- 服务器日志统计结果测试语句如下

  - 统计访问来源主机TOP 100和分别对应出现的总次数

    `bash job4/web_log.sh -a`

  - 统计访问来源主机TOP 100 IP和分别对应出现的总次数

    `bash job4/web_log.sh -b`

  - 统计最频繁被访问的URL TOP 100

    `bash job4/web_log.sh -c`

  - 统计不同响应状态码的出现次数和对应百分比

    `bash job4/web_log.sh -d`

  - 分别统计不同4XX状态码对应的TOP 10 URL和对应出现的总次数

    `bash job4/web_log.sh -e`

  - 给定URL输出TOP 100访问来源主机

    `bash job4/web_log.sh -f "in24.inetnebr.com"`



###### travis ci 使用

- 首先在travis中激活github的账号

  - 有个坑是travis有两个平台，这两个平台的区别如下，因根据使用仓库访问不同的网站，我要激活的是一个公开仓库，访问travis.org平台。并使用github进行认证登录。

    `we have 2 platforms, [https://travis-ci.org](https://travis-ci.org/) for open source projects and [https://travis-ci.com](https://travis-ci.com/) for closed source projects.`

  - 但是认真登陆后并没有在travis-setting仓库下找到我需要激活的仓库，在github中查看仓库所有者发现仓库owner是 `CUCCS`，于是直接访问`https://travis-ci.org/仓库所有者/仓库名`进行仓库的激活。

- travis运行的job log中，直接打印虚拟机输出的所有内容。



###### 参阅

- [https://github.com/CUCCS/linux/tree/master/2017-1/TJY/bash](https://github.com/CUCCS/linux/tree/master/2017-1/TJY/bash)
- [https://github.com/CUCCS/linux/tree/master/2017-1/snRNA](https://github.com/CUCCS/linux/tree/master/2017-1/snRNA)

- [Travis can not find my public repositories on GitHub](https://travis-ci.org/yourWaifu/example.)
- [Not showing my repositories ](https://github.com/travis-ci/travis-ci/issues/8689)
- [awk的BEGIN和END](https://blog.csdn.net/panpan639944806/article/details/19932543)